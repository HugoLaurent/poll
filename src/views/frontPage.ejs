<%- include('./partials/header') %>
   
        <h1 class="category-title">Most Popular</h1>
        <main>
            <% if(locals.errorMessage) { %>
            <p><%= errorMessage %></p>
            <% } %>
          <% for(const poll of polls) { %>
            
            <article>
                <form class="poll" action="" method="POST">
                        <h2><%= poll.title %></h2>
                    
                        <p classname="author"><%= poll.author.pseudo %></p>
                    </div>
                    <p><%= poll.question %></p>
                    <section class="polls">
                        <div class="wrapper-all-progress">
                            <input class="validatePoll" type="checkbox" id="first" name="choice" value="result_a">
                                                        
                            <div class="progressbar-wrapper">
                                <div style="width: <%=poll.result_a%>%" title="first_choice" class="progressbar">
                                    <p><%= poll.choice_a %></p>
                                </div>
                            </div>
                            <span class="choice"><%= poll.result_a%>%</span>
                        </div>
                        <div class="wrapper-all-progress">
                            <input class="validatePoll" type="checkbox" id="second" name="choice" value="result_b"> 
                                                       
                            <div class="progressbar-wrapper">
                                <div style="width: <%=poll.result_b%>%" title="second_choice" class="progressbar">
                                    
                                    <p><%= poll.choice_b %></p>
                                </div>
                            </div>
                            <span><%= poll.result_b%>%</span>
                        </div>
                    </div>                
                            </section>
                            <div class="footer-article">
                                <div class="share">
                    <img class="share-button" src="/images/share.svg" alt=""><span class="coming-soon"></span>
                    <input type="hidden" id="id" name="id" value="<%=poll.id%>">
                    <!-- <img src="/images/messenger.png" alt="">
                    <img src="/images/twitter.png" alt="">
                    <img src="/images/twitch.png" alt="">
                    <img src="/images/discord.png" alt=""> -->
                                </div>
                                <p><%= poll.result_a + poll.result_b %> votes</p>

                            
                                <!--Si poll.id est dans le tableau ALORS TU DISPARAIS -->
                                <% if(!votes.includes(poll.id)) {%>
                                <button class="article-button" type="submit">Validate</button>
                                <% } %>
                </form>
    </article>
    
<% } %> 
    
    <!-- POP UP FOR THE SIGN UP FORM -->
    <section class="sign-up form">
    <span class="to-close">x</span>
    <h1>Inscription Form</h1>
        <form action="" method="POST">
            <ul>
                <li><input placeholder="PrÃ©nom" type="text"></li>
                <li><input placeholder="Nom" type="text"></li>
                <li><input placeholder="Pseudo" type="text"></li>
                <li><input placeholder="E-mail" type="text"></li>
                <li><input placeholder="Password" type="text"></li>
            </ul>
            <ul class="conditions">
                <li><input class="private" type="checkbox">Lorem ipsum dolor sit amet, consectetur adipisicing elit. </li>
                <li><input class="private" type="checkbox">Lorem ipsum dolor sit amet consectetur.</li>
            </ul>
            <button type="submit">Validate</button>
        </form>
    </section>

    <!-- POP UP FOR THE CONNECT FORM -->

    <section class="connect form">
        <span class="to-close-connect">x</span>
        <h1>Connect Form</h1>
        <form action="" method="POST">
            <ul>
                <li><input placeholder="Pseudo" type="text"></li>
                <li><input placeholder="Password" type="text"></li>
            </ul>
            <button type="submit">Connect</button>
        </form>
    </section>

    <!-- POP UP FOR THE CREATE FORM -->

    <section class="create form">
        <span class="to-close-create">x</span>
        <h1>Create a poll</h1>
                <form action="" method="POST">
                    <ul>
                        <li><input placeholder="Title of your poll" type="text"></li>
                        <li><input placeholder="The question of your poll" type="text"></li>
                        <li><input placeholder="First choice" type="text"></li>
                        <li><input placeholder="Second choice" type="text"></li>
                    </ul>
                    <button type="submit">Validate</button>
                </form>
    </section>
</main>


<%- include('./partials/footer') %>   